# 要件ドキュメント

## はじめに

このプロジェクトは、自然言語クエリに基づいてレストランを検索できるAI駆動型レストラン検索アプリケーションの開発を目的としています。システムは複数のLLMを使用してユーザークエリを分析し、検索条件を抽出し、パーソナライズされたレストラン推薦を提供します。アプリケーションは、中央に検索ボックスがあるシンプルでモダンなインターフェースを特徴とし、ユーザーは「渋谷にある海鮮が美味しい居酒屋教えて」や「彼女と行ける雰囲気の良い和食屋さん教えて」などのクエリを入力できます。システムはこれらのクエリを処理し、構造化データと非構造化検索パラメータを抽出し、レストランデータベースを検索して、推薦テキストとマッチするレストランのリストの両方を返します。

## 要件

### 1. ユーザーインターフェース

**ユーザーストーリー:** ユーザーとして、目立つ検索ボックスを備えたクリーンでモダンなインターフェースが欲しい。そうすることで、レストラン検索クエリを簡単に入力できるようになる。

#### 受け入れ基準

1. ユーザーがサイトを訪問した時、システムは中央に検索ボックスがあるシンプルでモダンなインターフェースを表示すること。
2. ユーザーが検索ボックスに入力する時、システムは日本語または英語の自然言語クエリを受け付けること。
3. ユーザーがクエリを送信する時、システムは処理中にローディングインジケーターを表示すること。
4. 結果が準備できた時、システムは推薦テキストとマッチするレストランのリストをカード形式で表示すること。
5. ページが読み込まれる時、システムはレスポンシブであり、デスクトップとモバイルデバイスの両方で適切に動作すること。

### 2. 自然言語クエリ処理

**ユーザーストーリー:** ユーザーとして、自然言語を使用してレストランを検索したい。そうすることで、特定の検索構文を学ぶことなく、会話形式で自分の好みを表現できる。

#### 受け入れ基準

1. ユーザーがクエリを送信する時、システムは複数のLLMを使用してそれを分析し、検索パラメータを抽出すること。
2. クエリを処理する時、システムはデータベースフィルタリング用の構造化データ（場所、営業時間、料理タイプなど）を識別すること。
3. クエリを処理する時、システムは追加フィルタリング用の非構造化キーワード（雰囲気、品質記述子など）を識別すること。
4. クエリにあいまいな用語が含まれる時、システムはそれらを検索可能なキーワードに変換すること。
5. システムがクエリを理解できない時、システムは明確化を求めるフィードバックを提供すること。

### 3. マルチLLMオーケストレーション

**ユーザーストーリー:** システムアーキテクトとして、複数の専門化されたLLMをオーケストレーションしたい。そうすることで、各LLMがクエリ処理の特定の側面を処理し、最適な結果を得ることができる。

#### 受け入れ基準

1. クエリが受信された時、LLM_Aは検索パラメータを構造化データとキーワードに分類すること。
2. 構造化データが識別された時、LLM_Bはそれを抽出してデータベース検索を実行すること。
3. キーワードが識別された時、LLM_Cはそれらを検索可能な用語に変換してデータベース検索を実行すること。
4. 両方の検索タイプが完了した時、システムはANDロジックを使用して結果を組み合わせること。
5. 組み合わせた結果が利用可能な時、LLM_Dは結果に基づいて推薦テキストを生成すること。
6. LLMが処理している時、システムはオプションで思考プロセスをユーザーに表示すること。

### 4. レストランデータベース

**ユーザーストーリー:** ユーザーとして、システムが包括的なレストランデータベースを検索することを望む。そうすることで、正確で関連性の高い推薦を受け取ることができる。

#### 受け入れ基準

1. システムがデプロイされる時、テストと初期使用のためのシードデータを含めること。
2. 検索が実行される時、システムはLLMによって抽出されたパラメータを使用してデータベースにクエリを実行すること。
3. 結果が見つかった時、システムは推薦メッセージとレストランIDのリストの両方を返すこと。
4. 条件に一致する結果がない時、システムはユーザーに通知し、検索範囲を広げることを提案すること。
5. データベースにクエリが実行される時、システムは場所、料理タイプ、価格帯、営業時間、およびその他の構造化データによるフィルタリングをサポートすること。

### 5. 結果表示

**ユーザーストーリー:** ユーザーとして、レストランの推薦が明確に表示されることを望む。そうすることで、どのレストランを訪問するかを素早く決定できる。

#### 受け入れ基準

1. 検索結果が準備できた時、システムはパーソナライズされた推薦テキストを表示すること。
2. 検索結果が準備できた時、システムはマッチするレストランをカード形式で表示すること。
3. レストランカードが表示される時、各カードには必須情報（名前、場所、料理タイプなど）を含めること。
4. ユーザーがレストランカードをクリックする時、システムはより詳細な情報を表示すること。
5. 結果が見つからない時、システムは適切なメッセージを表示し、代替案を提案すること。

### 6. ユーザー管理

**ユーザーストーリー:** システム管理者として、一般ユーザーと管理者のための別々のユーザーロールが欲しい。そうすることで、管理機能が保護される。

#### 受け入れ基準

1. ユーザーが登録する時、システムはデフォルトで一般ユーザーアカウントを作成すること。
2. ユーザーが管理者登録リンクを通じて登録する時、システムは管理者ユーザーアカウントを作成すること。
3. 管理者ユーザーがログインする時、システムは管理機能へのアクセスを提供すること。
4. 管理者ユーザーが管理パネルにアクセスする時、システムはデータベースの内容と管理オプションを表示すること。
5. 一般ユーザーが管理機能にアクセスしようとする時、システムはアクセスを拒否し、適切にリダイレクトすること。

### 7. 管理者インターフェース

**ユーザーストーリー:** 管理者として、レストランデータを管理するための管理者インターフェースが欲しい。そうすることで、データベースを維持および更新できる。

#### 受け入れ基準

1. 管理者がログインする時、システムは管理ダッシュボードへのアクセスを提供すること。
2. 管理者がダッシュボードにアクセスする時、システムはデータベース統計と管理オプションを表示すること。
3. 管理者がレストランデータを表示する時、システムはそれを検索可能でフィルタリング可能なテーブルで表示すること。
4. 管理者がレストランデータを編集する時、システムはそれに応じてデータベースを更新すること。
5. 管理者が新しいレストランデータを追加する時、システムはそれを検証してデータベースに保存すること。

### 8. パフォーマンスとスケーラビリティ

**ユーザーストーリー:** ユーザーとして、アプリケーションがレスポンシブで高速であることを望む。そうすることで、レストランの推薦を素早く見つけることができる。

#### 受け入れ基準

1. ユーザーがクエリを送信する時、システムはそれを処理し、合理的な時間枠内（目標：5秒未満）で結果を返すこと。
2. 複数のユーザーが同時にシステムを使用している時、システムはパフォーマンスを維持すること。
3. データベースが成長する時、システムは効率的に動作し続けること。
4. LLM処理が行われている時、システムは進行状況に関するフィードバックを提供すること。
5. システムが高負荷を経験する時、それは増加した需要を適切に処理すること。